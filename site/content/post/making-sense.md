---
title: Using SSM to stream logs and metrics from MS Windows to CloudWatch
cftags:
  - 'AWS::EC2::VPC'
  - 'AWS::IAM::Role'
  - 'AWS::SSM::Association'
date: 2016-12-17T15:04:10.000Z
description: >-
  It seems a bit finikey to me, but it works - most of the time.
---

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nunc luctus, ipsum a tristique tincidunt, tellus nibh mollis orci, quis aliquam mauris sapien vitae erat. Nulla feugiat leo lectus, vitae condimentum sem lacinia quis. Curabitur sollicitudin ultrices mauris, non tempor dui sagittis vitae. Duis dictum commodo nibh. Integer in fringilla justo. Aliquam erat volutpat. Cras vel ipsum felis. Vivamus libero dui, scelerisque a sapien sit amet, viverra efficitur mi. Proin sollicitudin, diam a facilisis pulvinar, mauris erat scelerisque elit, nec sollicitudin diam lacus varius ligula. Aenean rutrum, nibh ut egestas tempus, turpis purus bibendum felis, sed pellentesque purus nulla ut elit. Phasellus felis leo, porttitor sagittis dui id, tincidunt posuere odio. Fusce volutpat ipsum nec tortor vestibulum, in lobortis diam ullamcorper.

In quis aliquet nisi. Suspendisse fringilla lacus interdum aliquam vestibulum. Suspendisse posuere mi risus. Vestibulum libero velit, ornare sed blandit vel, hendrerit in nulla. Donec risus justo, tempus eu cursus ac, facilisis sed augue. Pellentesque augue nibh, tempus eu placerat nec, lobortis consectetur urna. Aenean consequat odio enim, vel dignissim tortor finibus egestas. Nulla dapibus magna felis, tincidunt consectetur erat ultricies nec. Pellentesque ac quam euismod, varius velit sit amet, vulputate leo. Nunc tristique nisl at velit viverra, eu volutpat tellus dapibus. Maecenas commodo, metus at convallis accumsan, felis justo vulputate lacus, sit amet auctor nunc odio a lorem.


```javascript
function fancyAlert(arg) {
  if(arg) {
    $.facebox({div:'#foo'})
  }
}
```


Suspendisse potenti. Nunc nunc justo, cursus tincidunt tellus vel, euismod sodales lacus. Donec congue malesuada odio. Nunc eget tempus risus. Quisque accumsan lacus sed augue venenatis, ac blandit mi lacinia. Sed eget odio nec tellus porttitor imperdiet. Maecenas gravida mattis nibh, pulvinar imperdiet orci ornare at. Suspendisse elementum volutpat metus, a elementum ipsum eleifend sed. Donec fringilla dictum massa, ut congue ipsum. Cras cursus feugiat nisi at dapibus. Fusce laoreet semper laoreet. Curabitur facilisis mi ac urna iaculis, a commodo dui scelerisque. Integer lorem magna, viverra pharetra hendrerit lobortis, tempus sodales justo. Etiam vel vehicula erat.

Curabitur eleifend lectus mi, eu scelerisque odio rhoncus eget. Ut non augue dapibus felis scelerisque aliquam. Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Proin sodales ipsum sit amet sollicitudin tempor. Cras dignissim molestie nulla, quis porttitor dui tristique blandit. Fusce id enim et metus pretium pellentesque. Vivamus sollicitudin pharetra est eu pretium. Suspendisse scelerisque vulputate pulvinar. Donec molestie massa vitae nulla fringilla, et viverra tellus dapibus. Nunc et placerat justo. Suspendisse potenti.

Donec scelerisque purus eu imperdiet vulputate. Proin bibendum risus in metus varius, vitae suscipit ipsum lacinia. Donec augue purus, bibendum vel massa ut, consequat hendrerit tellus. Duis pellentesque vehicula eros, vitae suscipit diam tristique in. Aenean odio est, consectetur vel tortor non, tempor blandit purus. Curabitur quis est lorem. Donec pretium volutpat varius. Proin posuere interdum consectetur. In hac habitasse platea dictumst. Ut sagittis velit at elementum pellentesque. Integer viverra tortor mi, in elementum nisi aliquet eu. Lorem ipsum dolor sit amet, consectetur adipiscing elit.

Sed posuere tellus tellus, eu faucibus dui viverra sollicitudin. Suspendisse nisl nulla, rutrum sed vestibulum vitae, faucibus eu nibh. Quisque posuere lectus non erat ornare accumsan. Proin commodo tempor magna vel venenatis. Nulla condimentum leo nunc, vitae faucibus dui malesuada id. Integer molestie id nunc quis dignissim. Aliquam vulputate metus quis ultricies vestibulum.

```python
def do_something():
  more_things()
  and_even_more()
```

Etiam egestas tempus lectus eget sagittis. Sed ultrices sapien ante. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Pellentesque vestibulum augue erat, eget rutrum odio scelerisque non. Nullam gravida dictum elit, a luctus tortor volutpat in. Cras consectetur arcu luctus, fermentum eros sed, congue lorem. Etiam vitae magna sed mi porttitor hendrerit id quis metus. Nam eget condimentum nisi, id aliquam elit. Etiam facilisis, sapien eu tincidunt sollicitudin, felis massa ultricies est, id viverra odio mi ac magna. Curabitur non porttitor mi, a imperdiet erat.

Nam nec blandit felis. Maecenas mollis enim ut tellus congue placerat. Donec vel nunc quis metus venenatis eleifend. Sed gravida nunc nec iaculis ultricies. Aenean sed diam gravida, venenatis felis posuere, venenatis urna. Etiam fringilla dictum mattis. Pellentesque elementum dictum quam, a convallis dolor dictum eu. Aliquam neque urna, finibus ut mollis quis, tempor ac mauris. Etiam gravida mi neque, vitae dapibus lacus consectetur at. Sed aliquet pulvinar euismod. Sed porta, enim non tempor sodales, diam quam volutpat nunc, vel ultrices est velit a lectus. In dapibus lectus felis, nec suscipit enim eleifend non. Ut congue imperdiet posuere. Vivamus laoreet, est vel lobortis pellentesque, ipsum elit feugiat ligula, quis commodo metus augue eu lectus.

```json
{
  "AWSTemplateFormatVersion" : "2010-09-09",

  "Description" : "AWS CloudFormation Sample Template Route53_A: Sample template showing how to create an Amazon Route 53 A record that maps to the public IP address of an EC2 instance. It assumes that you already have a Hosted Zone registered with Amazon Route 53. **WARNING** This template creates an Amazon EC2 instance. You will be billed for the AWS resources used if you create a stack from this template.",

  "Parameters" : {
    "InstanceType" : {
      "Description" : "WebServer EC2 instance type",
      "Type" : "String",
      "Default" : "t2.small",
      "AllowedValues" : [ "t1.micro", "t2.nano", "t2.micro", "t2.small", "t2.medium", "t2.large", "m1.small", "m1.medium", "m1.large", "m1.xlarge", "m2.xlarge", "m2.2xlarge", "m2.4xlarge", "m3.medium", "m3.large", "m3.xlarge", "m3.2xlarge", "m4.large", "m4.xlarge", "m4.2xlarge", "m4.4xlarge", "m4.10xlarge", "c1.medium", "c1.xlarge", "c3.large", "c3.xlarge", "c3.2xlarge", "c3.4xlarge", "c3.8xlarge", "c4.large", "c4.xlarge", "c4.2xlarge", "c4.4xlarge", "c4.8xlarge", "g2.2xlarge", "g2.8xlarge", "r3.large", "r3.xlarge", "r3.2xlarge", "r3.4xlarge", "r3.8xlarge", "i2.xlarge", "i2.2xlarge", "i2.4xlarge", "i2.8xlarge", "d2.xlarge", "d2.2xlarge", "d2.4xlarge", "d2.8xlarge", "hi1.4xlarge", "hs1.8xlarge", "cr1.8xlarge", "cc2.8xlarge", "cg1.4xlarge"]
,
      "ConstraintDescription" : "must be a valid EC2 instance type."
    },

    "HostedZone" : {
      "Type" : "String",
      "Description" : "The DNS name of an existing Amazon Route 53 hosted zone",
      "AllowedPattern" : "(?!-)[a-zA-Z0-9-.]{1,63}(?<!-)",
      "ConstraintDescription" : "must be a valid DNS zone name."
    }
  },

  "Mappings" : {
    "AWSInstanceType2Arch" : {
      "t1.micro"    : { "Arch" : "PV64"   },
      "t2.nano"     : { "Arch" : "HVM64"  },
      "t2.micro"    : { "Arch" : "HVM64"  },
      "t2.small"    : { "Arch" : "HVM64"  },
      "t2.medium"   : { "Arch" : "HVM64"  },
      "t2.large"    : { "Arch" : "HVM64"  },
      "m1.small"    : { "Arch" : "PV64"   },
      "m1.medium"   : { "Arch" : "PV64"   },
      "m1.large"    : { "Arch" : "PV64"   },
      "m1.xlarge"   : { "Arch" : "PV64"   },
      "m2.xlarge"   : { "Arch" : "PV64"   },
      "m2.2xlarge"  : { "Arch" : "PV64"   },
      "m2.4xlarge"  : { "Arch" : "PV64"   },
      "m3.medium"   : { "Arch" : "HVM64"  },
      "m3.large"    : { "Arch" : "HVM64"  },
      "m3.xlarge"   : { "Arch" : "HVM64"  },
      "m3.2xlarge"  : { "Arch" : "HVM64"  },
      "m4.large"    : { "Arch" : "HVM64"  },
      "m4.xlarge"   : { "Arch" : "HVM64"  },
      "m4.2xlarge"  : { "Arch" : "HVM64"  },
      "m4.4xlarge"  : { "Arch" : "HVM64"  },
      "m4.10xlarge" : { "Arch" : "HVM64"  },
      "c1.medium"   : { "Arch" : "PV64"   },
      "c1.xlarge"   : { "Arch" : "PV64"   },
      "c3.large"    : { "Arch" : "HVM64"  },
      "c3.xlarge"   : { "Arch" : "HVM64"  },
      "c3.2xlarge"  : { "Arch" : "HVM64"  },
      "c3.4xlarge"  : { "Arch" : "HVM64"  },
      "c3.8xlarge"  : { "Arch" : "HVM64"  },
      "c4.large"    : { "Arch" : "HVM64"  },
      "c4.xlarge"   : { "Arch" : "HVM64"  },
      "c4.2xlarge"  : { "Arch" : "HVM64"  },
      "c4.4xlarge"  : { "Arch" : "HVM64"  },
      "c4.8xlarge"  : { "Arch" : "HVM64"  },
      "g2.2xlarge"  : { "Arch" : "HVMG2"  },
      "g2.8xlarge"  : { "Arch" : "HVMG2"  },
      "r3.large"    : { "Arch" : "HVM64"  },
      "r3.xlarge"   : { "Arch" : "HVM64"  },
      "r3.2xlarge"  : { "Arch" : "HVM64"  },
      "r3.4xlarge"  : { "Arch" : "HVM64"  },
      "r3.8xlarge"  : { "Arch" : "HVM64"  },
      "i2.xlarge"   : { "Arch" : "HVM64"  },
      "i2.2xlarge"  : { "Arch" : "HVM64"  },
      "i2.4xlarge"  : { "Arch" : "HVM64"  },
      "i2.8xlarge"  : { "Arch" : "HVM64"  },
      "d2.xlarge"   : { "Arch" : "HVM64"  },
      "d2.2xlarge"  : { "Arch" : "HVM64"  },
      "d2.4xlarge"  : { "Arch" : "HVM64"  },
      "d2.8xlarge"  : { "Arch" : "HVM64"  },
      "hi1.4xlarge" : { "Arch" : "HVM64"  },
      "hs1.8xlarge" : { "Arch" : "HVM64"  },
      "cr1.8xlarge" : { "Arch" : "HVM64"  },
      "cc2.8xlarge" : { "Arch" : "HVM64"  }
    },

    "AWSInstanceType2NATArch" : {
      "t1.micro"    : { "Arch" : "NATPV64"   },
      "t2.nano"     : { "Arch" : "NATHVM64"  },
      "t2.micro"    : { "Arch" : "NATHVM64"  },
      "t2.small"    : { "Arch" : "NATHVM64"  },
      "t2.medium"   : { "Arch" : "NATHVM64"  },
      "t2.large"    : { "Arch" : "NATHVM64"  },
      "m1.small"    : { "Arch" : "NATPV64"   },
      "m1.medium"   : { "Arch" : "NATPV64"   },
      "m1.large"    : { "Arch" : "NATPV64"   },
      "m1.xlarge"   : { "Arch" : "NATPV64"   },
      "m2.xlarge"   : { "Arch" : "NATPV64"   },
      "m2.2xlarge"  : { "Arch" : "NATPV64"   },
      "m2.4xlarge"  : { "Arch" : "NATPV64"   },
      "m3.medium"   : { "Arch" : "NATHVM64"  },
      "m3.large"    : { "Arch" : "NATHVM64"  },
      "m3.xlarge"   : { "Arch" : "NATHVM64"  },
      "m3.2xlarge"  : { "Arch" : "NATHVM64"  },
      "m4.large"    : { "Arch" : "NATHVM64"  },
      "m4.xlarge"   : { "Arch" : "NATHVM64"  },
      "m4.2xlarge"  : { "Arch" : "NATHVM64"  },
      "m4.4xlarge"  : { "Arch" : "NATHVM64"  },
      "m4.10xlarge" : { "Arch" : "NATHVM64"  },
      "c1.medium"   : { "Arch" : "NATPV64"   },
      "c1.xlarge"   : { "Arch" : "NATPV64"   },
      "c3.large"    : { "Arch" : "NATHVM64"  },
      "c3.xlarge"   : { "Arch" : "NATHVM64"  },
      "c3.2xlarge"  : { "Arch" : "NATHVM64"  },
      "c3.4xlarge"  : { "Arch" : "NATHVM64"  },
      "c3.8xlarge"  : { "Arch" : "NATHVM64"  },
      "c4.large"    : { "Arch" : "NATHVM64"  },
      "c4.xlarge"   : { "Arch" : "NATHVM64"  },
      "c4.2xlarge"  : { "Arch" : "NATHVM64"  },
      "c4.4xlarge"  : { "Arch" : "NATHVM64"  },
      "c4.8xlarge"  : { "Arch" : "NATHVM64"  },
      "g2.2xlarge"  : { "Arch" : "NATHVMG2"  },
      "g2.8xlarge"  : { "Arch" : "NATHVMG2"  },
      "r3.large"    : { "Arch" : "NATHVM64"  },
      "r3.xlarge"   : { "Arch" : "NATHVM64"  },
      "r3.2xlarge"  : { "Arch" : "NATHVM64"  },
      "r3.4xlarge"  : { "Arch" : "NATHVM64"  },
      "r3.8xlarge"  : { "Arch" : "NATHVM64"  },
      "i2.xlarge"   : { "Arch" : "NATHVM64"  },
      "i2.2xlarge"  : { "Arch" : "NATHVM64"  },
      "i2.4xlarge"  : { "Arch" : "NATHVM64"  },
      "i2.8xlarge"  : { "Arch" : "NATHVM64"  },
      "d2.xlarge"   : { "Arch" : "NATHVM64"  },
      "d2.2xlarge"  : { "Arch" : "NATHVM64"  },
      "d2.4xlarge"  : { "Arch" : "NATHVM64"  },
      "d2.8xlarge"  : { "Arch" : "NATHVM64"  },
      "hi1.4xlarge" : { "Arch" : "NATHVM64"  },
      "hs1.8xlarge" : { "Arch" : "NATHVM64"  },
      "cr1.8xlarge" : { "Arch" : "NATHVM64"  },
      "cc2.8xlarge" : { "Arch" : "NATHVM64"  }
    }
,
    "AWSRegionArch2AMI" : {
      "us-east-1"        : {"PV64" : "ami-2a69aa47", "HVM64" : "ami-6869aa05", "HVMG2" : "ami-22b68b59"},
      "us-west-2"        : {"PV64" : "ami-7f77b31f", "HVM64" : "ami-7172b611", "HVMG2" : "ami-be4ea3c6"},
      "us-west-1"        : {"PV64" : "ami-a2490dc2", "HVM64" : "ami-31490d51", "HVMG2" : "ami-cfe5cfaf"},
      "eu-west-1"        : {"PV64" : "ami-4cdd453f", "HVM64" : "ami-f9dd458a", "HVMG2" : "ami-aedb26d7"},
      "eu-west-2"        : {"PV64" : "NOT_SUPPORTED", "HVM64" : "ami-886369ec", "HVMG2" : "NOT_SUPPORTED"},
      "eu-central-1"     : {"PV64" : "ami-6527cf0a", "HVM64" : "ami-ea26ce85", "HVMG2" : "ami-40b8102f"},
      "ap-northeast-1"   : {"PV64" : "ami-3e42b65f", "HVM64" : "ami-374db956", "HVMG2" : "ami-d95aabbf"},
      "ap-northeast-2"   : {"PV64" : "NOT_SUPPORTED", "HVM64" : "ami-2b408b45", "HVMG2" : "NOT_SUPPORTED"},
      "ap-southeast-1"   : {"PV64" : "ami-df9e4cbc", "HVM64" : "ami-a59b49c6", "HVMG2" : "ami-15660276"},
      "ap-southeast-2"   : {"PV64" : "ami-63351d00", "HVM64" : "ami-dc361ebf", "HVMG2" : "ami-0b5a4168"},
      "ap-south-1"       : {"PV64" : "NOT_SUPPORTED", "HVM64" : "ami-ffbdd790", "HVMG2" : "ami-f4cdb79b"},
      "us-east-2"        : {"PV64" : "NOT_SUPPORTED", "HVM64" : "ami-f6035893", "HVMG2" : "NOT_SUPPORTED"},
      "ca-central-1"     : {"PV64" : "NOT_SUPPORTED", "HVM64" : "ami-730ebd17", "HVMG2" : "NOT_SUPPORTED"},
      "sa-east-1"        : {"PV64" : "ami-1ad34676", "HVM64" : "ami-6dd04501", "HVMG2" : "NOT_SUPPORTED"},
      "cn-north-1"       : {"PV64" : "ami-77559f1a", "HVM64" : "ami-8e6aa0e3", "HVMG2" : "NOT_SUPPORTED"}
    }

  },

  "Resources" : {
    "EC2Instance" : {
      "Type" : "AWS::EC2::Instance",
      "Properties" : {
        "ImageId" : { "Fn::FindInMap" : [ "AWSRegionArch2AMI", { "Ref" : "AWS::Region" },
                          { "Fn::FindInMap" : [ "AWSInstanceType2Arch", { "Ref" : "InstanceType" }, "Arch" ] } ] },
        "InstanceType" : { "Ref" : "InstanceType" }
      }
    },

    "MyDNSRecord" : {
      "Type" : "AWS::Route53::RecordSet",
      "Properties" : {
        "HostedZoneName" : { "Fn::Join" : [ "", [{"Ref" : "HostedZone"}, "." ]]},
        "Comment" : "DNS name for my instance.",
        "Name" : { "Fn::Join" : [ "", [{"Ref" : "EC2Instance"}, ".", {"Ref" : "AWS::Region"}, ".", {"Ref" : "HostedZone"} ,"."]]},
        "Type" : "A",
        "TTL" : "900",
        "ResourceRecords" : [ { "Fn::GetAtt" : [ "EC2Instance", "PublicIp" ] } ]
      }
    }
  },

  "Outputs" : {
    "DomainName" : {
      "Description" : "Fully qualified domain name",
      "Value" : { "Ref" : "MyDNSRecord" }
    }
  }
}
```

Nam cursus lacus in eros venenatis commodo. Duis dapibus quam eu rhoncus commodo. Integer malesuada scelerisque ante, a vulputate turpis tempor vitae. Mauris tincidunt lacus sit amet volutpat luctus. Aenean blandit ipsum eget imperdiet mattis. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Nam molestie nibh a ex mattis pharetra. Phasellus eget tempus lacus. Vivamus non erat risus. Sed ultrices sit amet sapien blandit elementum. Donec ac varius lorem, et elementum nulla. Nunc dapibus, mi vel tempor convallis, tortor augue porttitor justo, ut malesuada tellus magna sit amet purus. Fusce bibendum, massa eu condimentum ullamcorper, ex eros elementum lectus, nec congue enim enim vitae tortor.

Proin in ex sem. Sed eu porttitor felis. Integer bibendum odio quis tellus euismod pulvinar. Aenean dapibus mi nisl, id rutrum lectus placerat ut. Quisque id neque lorem. Aenean sodales turpis et est blandit, ut faucibus felis posuere. Nullam vel malesuada libero. Vestibulum rhoncus arcu ut felis facilisis hendrerit. Cras vitae lorem vel urna dignissim euismod. Phasellus eget mauris ante. Pellentesque mattis urna tortor. Vestibulum lacinia id lectus eu volutpat. Praesent sed nisi pharetra, fermentum orci sed, porta elit.

